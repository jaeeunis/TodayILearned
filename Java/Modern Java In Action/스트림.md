# Modern Java In Action

## CHAPTER 4 스트림

> 스트림은 자바8 API에 새로 추가된 기능이다. 스트림을 이용하면 **선언형** (즉, 데이터를 처리하는 임시 구현 코드 대신 질의로 표현 할 수 있다.)으로 컬렉션 데이터를 처리할 수 있다. 간단하게 말해서, 스트림이 데이터 컬렉션 반복을 멋지게 처리할 수 있다.
> 또한 스트림을 이용하면 멀티스레드 코드를 구현하지 않아도 데이터를 투명하게 병렬로 처리할 수 있다. 

<br>

### 4-1 스트림이란 무엇인가 ?

스트림을 사용하지 않고 컴퓨터 성능이 좋은 이름을 가져오기 위해서는 **가비지 변수**를 사용했다. hiperformanceComputerName을 구하기 위해서 중간 컨테이너 역할만 하는 변수이다. 

```java
List<Computer> hiperformanceComputer = new ArrayList<>();
for (Computer computer:inventory){
  	if (computer.getSpeed() > 200) {
      	hiperformanceComputer.add(computer);
    }
}

Collections.sort(hiperformanceComputer, new Comparator<Computer>() {
  public int compare(Computer computer1, Computer computer2) {
    return Integer.compare(computer1.getSpeed(), computer2.getSpeed());
  }
});

List<String> hiperformanceComputerName = new ArrayList<>();
for (Computer computer : hiperformanceComputer) {
  	hiperformanceComputerName.add(computer.getName());
}
```

하지만 스트림을 사용하면 **선언형**으로 코드를 구현할 수 있다. if 조건문 등의 제어 블록을 사용해서 어떻게 동작을 구현할지 지정할 필요없이 원하는 조건의 변수를 가져오는 동작을 수행할 수 있다. 

```java
List<String> hiperformanceComputerName = inventory.stream()
																									.filter(c -> c.getSpeed() > 200)
																									.sorted(comparing(Computer::getSpeed))
																									.map(Computer::getName)
																									.colled(toList());
```

위 처럼 `filter, sorted, map, collect` 같은 여러 빌딩 블록 연산을 연결해서 복잡한 데이터 처리 파이프라인을 만들 수 있다. 여러 연산을 파이프라인으로 연결해도 여전히 가독성과 명확성이 유지된다. 

<br>

#### 4-2 스트림 특징

`스트림(stream)` : 정확하게 스트림이란 "데이터 처리 연산을 지원하도록 소스에서 추출된 연속된 요소로 정의할 수 있다" 

1. **연속된 요소** : 컬렉션과 마찬가지로 스트림은 특정 요소 형식으로 이루어진 연속된 값 집합의 인터페이스를 제공한다. 컬렉션은 자료구조이므로 컬렉션에서는 (ArrayList 또는 LinkedList를 사용할 것인지에 대한) 시간과 공간의 복잡성이 주를 이루지만 스트림은 filter, sorted, map 처럼 표현 계산식이 주를 이룬다. 

2. **소스** : 스트림은 컬렉션, I/O 자원 등의 데이터 제공 소스로부터 데이터를 소비한다. 정렬된 컬렉션으로 스트림을 생성하면 정렬이 그대로 유지된다.

3. **데이터 처리연산** : 스트림은 일반적으로 지원하는 연산과 데이터베이스와 비슷한 연산을 지원한다.

4. **파이프 라이닝** : 대부분의 스트림 연산은 스트림 연산끼리 연결해서 커다란 파이프 라인을 구성할 수 있도록 스트림 자신을 반환한다.

5. **내부 반복** : 반복자를 이용해서 명시적으로 반복하는 컬렉션과 달리 스트림은 내부 반복을 지원한다.

   <br>

#### 4-3 스트림 연산

`filter` : 람다를 인수로 받아 스트림에서 특정 요소를 제외시킨다. <br>
`map` : 람다를 이용해서 한 요소를 다른 요소로 변환하거나 정보를 추출한다. <br>
`collect` : 스트림을 다른 형식으로 변환한다. 다양한 변환 방법을 인수로 받아 스트림에 누적된 요소를 특정 결과로 변환시키는 기능을 수행한다. 

<br>

#### 4-3 스트림과 컬렉션

자바의 기존 컬렉션과 스트림 모두 연속된 요소 형식의 값을 저장하는 자료구조의 인터페이스를 제공한다. **연속된** 이라는 표현은 순서와 상관없이가 아니라 순차적으로 값에 접근한다는 것이다. 
둘의 가장 큰 차이점은 데이터를 **언제 계산** 하느냐이다. 컬렉션은 현재 자료구조가 포함하는 모든 값을 메모리에 저장하는 자료구조다. 컬렉션의 모든 요소는 컬렉션에 추가하기 전에 계산되어야 한다. 반면에 스트림은 **요청할 때만 요소를 계산** 하는 고정된 자료구조다.
**사용자가 요청하는 값만 스트림에서 추출한다는 것이 핵심이다.** 

